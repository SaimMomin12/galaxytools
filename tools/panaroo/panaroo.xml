<tool id="panaroo" name="Panaroo" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="23.02" license="MIT">
    <description>Generate accurate pangenomes by identifying, grouping, and analyzing core and accessory genes from GFF3 files across multiple genomes.</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <edam_topics>
        <edam_topic>topic_3945</edam_topic>
        <edam_topic>topic_0084</edam_topic>
        <edam_topic>topic_3053</edam_topic>
    </edam_topics>
    <edam_operations>
        <edam_operation>operation_3432</edam_operation>
        <edam_operation>operation_2424</edam_operation>
        <edam_operation>operation_0337</edam_operation>
    </edam_operations>
    <xrefs>
        <xref type="bio.tools">Panaroo</xref>
    </xrefs>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
        mkdir -p out/ &&
        panaroo
            #if $input1:
                -i ${str($input1).replace(',', ' ')}
            #end if
            -o out
            --clean-mode '${modes.clean_mode}'
            #if $remove_invalid_genes:
                $modes.remove_invalid_genes
            #end if
            #if $threshold:
                --threshold '$matching.threshold' 
            #end if
            #if $family_threshold:
                --family_threshold '$matching.family_threshold'
            #end if
            #if $len_dif_percent:
                --len_dif_percent '$matching.len_dif_percent'
            #end if
            #if $family_len_dif_percent:
                --family_len_dif_percent '$matching.family_len_dif_percent'
            #end if
            #if $merge_paralogs:
                $matching.merge_paralogs
            #end if
            #if $search_radius:
                --search_radius '$refind.search_radius'
            #end if
            #if $refind_prop_match:
                --refind_prop_match '$refind.refind_prop_match'
            #end if
            #if $refind_mode:
                --refind-mode '$refind.refind_mode'
            #end if
            #if $min_trailing_support:
                --min_trailing_support '$graph_correction.min_trailing_support'
            #end if
            #if $edge_support_threshold:
                --edge_support_threshold '$graph_correction.edge_support_threshold'
            #end if
            #if $length_outlier_support_proportion:
                --length_outlier_support_proportion '$graph_correction.length_outlier_support_proportion'
            #end if
            #if $remove_by_consensus:
                --remove_by_consensus '${graph_correction.remove_by_consensus}'
            #end if
            #if $high_var_flag:
                --high_var_flag '$graph_correction.high_var_flag'
            #end if
            #if $min_edge_support_sv:
                --min_edge_support_sv '$graph_correction.min_edge_support_sv'
            #end if
            #if $all_seq_in_graph:
                --all_seq_in_graph '$graph_correction.all_seq_in_graph'
            #end if
            #if $no_clean_edges:
                --no_clean_edges '$graph_correction.no_clean_edges'
            #end if
            #if $alignment:
                -a '$gene_alignment.alignment'
            #end if
            #if $aligner:
                --aligner '$gene_alignment.aligner'
            #end if
            #if $codons:
                --codons '$gene_alignment.codons'
            #end if
            #if $core_threshold:
                --core_threshold '$gene_alignment.core_threshold'
            #end if
            #if $core_subset:
                --core_subset '${gene_alignment.core_subset}'
            #end if
            #if $core_entropy_filter:
                --core_entropy_filter '$gene_alignment.core_entropy_filter'
            #end if
    ]]></command>
    
    <inputs>
        <param type="data" name="input1" format="gff3" multiple="true" label="Select gff inputs to Panaroo" help="Select the files you wish to analyze with Panaroo, must be in gff3 format."/>
        <!--MODES-->
        <section name="modes" title="Panaroo Mode"  expanded="true">
            <param argument="--clean-mode" type="select" label="filtering mode" help="The stringency mode at which to run panaroo. Each of these modes can be fine tuned using the additional parameters in the 'Graph correction' section.">
                <option value="strict" selected="True">Strict</option>
                <option value="moderate">Moderate</option>
                <option value="sensitive">Sensitive</option>
            </param>
            <param argument="--remove-invalid-genes" type="boolean" optional="true" truevalue="--remove-invalid-genes" falsevalue="" label="Remove Invalid Genes" help="Removes annotations that do not conform to the expected Prokka format. Disabled by default."/>
        </section>
        <!--Matching-->
        <section name="matching" title="Matching"  expanded="false">
            <param argument="--threshold" type="float" optional="true" value="0.98" label="Sequence identity threshold" help="Set the threshold for gene clustering."/>
            <param argument="--family_threshold" type="float" optional="true" value="0.7" label="Family Sequence Identity Level" help="Set the level at which Panaroo collapses genes into putative families."/>
            <param argument="--len_dif_percent" type="float" optional="true" value="0.98" label="Length Difference Percent" help="Set the length difference percent for initial gene clustering."/>
            <param argument="--family_len_dif_percent" type="float" optional="true" value="0.0" label="Family Length Difference Percent" help="Set the length difference cutoff at the gene family level."/>
            <param argument="--merge_paralogs" type="boolean" optional="true" truevalue="--merge_paralogs" falsevalue="" label="Merge Paralogs"/>
        </section>
        <!--Refind-->
        <section name="refind" title="Refind"  expanded="false">
            <param argument="--search_radius" type="integer" optional="true" value="5000" label="Refinding Search Radius" help="The distance in nucleotides surronding the neighbour of an accessory gene in which to search for it"/>
            <param argument="--refind_prop_match" type="float" optional="true" value="0.5" label="Refinding Proportion Match" help="The proportion of an accessory gene that must be found in order to consider it a match"/>
            <param argument="--refind-mode" type="select" optional="true" label="Refind Mode" help="Set the stringency mode at which to re-find genes.">
            <option value="default" selected="true">Default</option>
                <option value="strict">Strict</option>
                <option value="off ">Off</option>
            </param>
        </section>
        <!--Graph Correction-->
        <section name="graph_correction" title="Graph Correctio"  expanded="false">
            <param argument="--min_trailing_support" type="integer" optional="true" value="0" label="Min Trailing Support" help="Minimum cluster size to keep a gene called at the end of a contig."/>
            <param argument="--trailing_recursive" type="integer" optional="true" value="1" label="Trailing Recursive" help="Number of times to perform recursive trimming of low support nodes near the end of contigs"/>
            <param argument="--edge_support_threshold" type="float" optional="true" value="0.1" label="Edge Support Threshold" help="Minimum support required to keep an edge that has been flagged as a possible mis-assembly."/>
            <param argument="--length_outlier_support_proportion" type="float" optional="true" value="0.01" label="Length Outlier Support Proportion" help="Proportion of genomes supporting a gene with a length more than 1.5x outside the interquatile range for genes in the same cluster."/>
            <param argument="--remove_by_consensus" type="select" optional="true" label="Remove By Consensus" help="If a gene is called in the same region with similar sequence a minority of the time, remove it.">
                <option value="True">true</option>
                <option value="False" selected="True">false</option>
            </param>         
            <param argument="--high_var_flag" type="integer" optional="true" value="5" label="High Var Flag" help="Minimum number of nested cycles to call a highly variable gene region."/>
            <param argument="--min_edge_support_sv" type="integer" optional="true" value="1" label="Min Edge Support SV" help="Minimum edge support required to call structural variants in the presence/absence sv file"/>
            <param argument="--all_seq_in_graph" type="boolean" optional="true" label="All Seq in Graph" truevalue="--all_seq_in_graph" falsevalue="" help="Retains all DNA sequence for each gene cluster in the graph output." />
            <param argument="--no_clean_edges" type="boolean" optional="true" label="No Clean Edges" truevalue="--no_clean_edges" falsevalue="" help="Turn off edge filtering in the final output graph." />
        </section>
        <!--Gene Alignment-->
        <section name="gene_alignment" title="Gene Alignment"  expanded="false">
            <param argument="--alignment" type="select" optional="true" label="Output alignments of core genes or all genes">
                <option value="core" selected="True">Core genome alignment</option>
                <option value="pan">Pan-genome alignment</option>
            </param>
            <param argument="--aligner" type="select" optional="true" label="Alignment method" help="Choose an aligner from either PRANK, Clustal or the default, MAFFT.">
                <option value="mafft" selected="True">MAFFT</option>
                <option value="clustal">Clustal</option>
                <option value="prank">PRANK</option>
            </param>
            <param argument="--codons" type="boolean" optional="true" label="Codons" truevalue="--codons" falsevalue="" help="Generate codon alignments by aligning sequences at the protein level"/>
            <param argument="--core_threshold" type="float" optional="true" value="0.95" label="Core Threshold"  help="Core-genome sample threshold"/>
            <param argument="--core_subset" type="boolean" optional="true" label="Core Subset" truevalue="--core_subset" falsevalue="" help="Core-genome sample threshold"/>
            <param argument="--core_entropy_filter" type="float" optional="true" value="0.5" label="Core Entropy Filter"  help="Manually set the Block Mapping and Gathering with Entropy (BMGE) filter. By default this is set using the Tukey outlier method."/>
        </section>
    </inputs>
    <outputs>
        <data format="csv" name="gene_p_a" label="${tool.name} on ${on_string} Gene Presence Absence" from_work_dir="out/gene_presence_absence.csv"/>
        <data format="fasta" name="core_gene_aln" label="${tool.name} on ${on_string} Core Gene Alignment" from_work_dir="out/core_gene_alignment.aln"/>
        <data format="txt" name="final_graph" label="${tool.name} on ${on_string} Final Graph" from_work_dir="out/final_graph.txt"/>
        <data format="txt" name="gene_p_a_rtab" label="${tool.name} on ${on_string} Gene Presence Absence Rtab" from_work_dir="out/gene_presence_absence.Rtab"/>
        <data format="csv" name="struct_presence_absence" label="${tool.name} on ${on_string} Struct Presence Absence" from_work_dir="out/struct_presence_absence.csv"/>
        <data format="fasta" name="pan_genome_ref" label="${tool.name} on ${on_string} pan-genome reference" from_work_dir="out/pan_genome_reference.fa"/>
        <data format="csv" name="gene_data" label="${tool.name} on ${on_string} Gene Data" from_work_dir="out/gene_data.csv"/>
        <data format="fasta" name="combined_DNA_CDS" label="${tool.name} on ${on_string} Combined DNA CDS" from_work_dir="out/combined_DNA_CDS.fasta"/>
        <data format="fasta" name="combined_protein_CDS" label="${tool.name} on ${on_string} Combined Protein CDS" from_work_dir="out/combined_protein_CDS.fasta"/>
        <data format="fasta" name="core_gene_alignment_filtered" label="${tool.name} on ${on_string} Core Gene Alignment Filtered" from_work_dir="out/core_gene_alignment_filtered.aln"/>
    </outputs>
    <tests>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <param name="no_clean_edges" value="true"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <param name="no_clean_edges" value="true"/>
            <param name="alignment" value="pan"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <param name="no_clean_edges" value="true"/>
            <param name="alignment" value="pan"/>
            <param name="aligner" value="mafft"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_text_matching expression="atgacacatttgacaaaggttttagatacactaactggaatatgcgtagtattattattt" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <param name="no_clean_edges" value="true"/>
            <param name="alignment" value="pan"/>
            <param name="aligner" value="mafft"/>
            <param name="codons" value="true"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <param name="no_clean_edges" value="true"/>
            <param name="alignment" value="pan"/>
            <param name="aligner" value="mafft"/>
            <param name="codons" value="true"/>
            <param name="core_threshold" value="0.95"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <param name="no_clean_edges" value="true"/>
            <param name="alignment" value="pan"/>
            <param name="aligner" value="mafft"/>
            <param name="codons" value="true"/>
            <param name="core_threshold" value="0.95"/>
            <param name="core_subset" value="true"/>
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <param name="no_clean_edges" value="true"/>
            <param name="alignment" value="pan"/>
            <param name="aligner" value="mafft"/>
            <param name="codons" value="true"/>
            <param name="core_threshold" value="0.95"/>
            <param name="core_subset" value="true"/>
            <param name="core_entropy_filter" value="0.5"/>        
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="10">
            <param name="input1" value="ex1.gff,ex2.gff" ftype="gff3"/>
            <param name="clean_mode" value="sensitive"/>
            <param name="remove_invalid_genes" value="true"/>
            <param name="threshold" value="0.98"/>
            <param name="family_threshold" value="0.7"/>
            <param name="len_dif_percent" value="0.98"/>
            <param name="merge_paralogs" value="true"/>
            <param name="search_radius" value="5000"/>
            <param name="refind_prop_match" value="0.5"/>
            <param name="refind_mode" value="strict"/>
            <param name="min_trailing_support" value="10"/>
            <param name="edge_support_threshold" value="0.1"/>
            <param name="length_outlier_support_proportion" value="0.01"/>
            <param name="remove_by_consensus" value="true"/>
            <param name="high_var_flag" value="5"/>
            <param name="min_edge_support_sv" value="1"/>
            <param name="all_seq_in_graph" value="true"/>
            <param name="no_clean_edges" value="true"/>
            <param name="alignment" value="pan"/>
            <param name="aligner" value="mafft"/>
            <param name="codons" value="true"/>
            <param name="core_threshold" value="0.95"/>
            <param name="core_entropy_filter" value="0.5"/>        
            <output name="gene_p_a" ftype="csv">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="core_gene_aln" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
            <output name="final_graph" ftype="txt">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="gene_p_a_rtab" ftype="txt">
                <assert_contents>
                    <has_n_lines n="15" delta="1" min="1"/>
                    <has_n_columns n="3" />
                </assert_contents>
            </output>
            <output name="struct_presence_absence" ftype="csv">
                <assert_contents>
                    <has_n_lines n="0" delta="1" min="0"/>
                    <has_text_matching expression="" />
                </assert_contents>
            </output>
            <output name="pan_genome_ref" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="150" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="gene_data" ftype="csv">
                <assert_contents>
                    <has_n_lines n="29" delta="1" min="1"/>
                    <has_text_matching expression="gff_file,scaffold_name,clustering_id,annotation_id,prot_sequence,dna_sequence,gene_name,description" />
                </assert_contents>
            </output>
            <output name="combined_DNA_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="300" delta="1" min="1"/>
                    <has_text_matching expression="ATGAAAACACGTATAGTCAGCTCAGTAACAACAACACTATTGCTAGGTTCCATATTAATG" />
                </assert_contents>
            </output>
            <output name="combined_protein_CDS" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="130" delta="1" min="1"/>
                    <has_text_matching expression="MKTRIVSSVTTTLLLGSILMNPVANAADSDINIKTGTTDIGSNTTVKTGDLVTYDKENGM" />
                </assert_contents>
            </output>
            <output name="core_gene_alignment_filtered" ftype="fasta">
                <assert_contents>
                    <has_n_lines n="260" delta="1" min="1"/>
                    <has_n_columns n="1" />
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[

**Panaroo**

Panaroo is a pangenome analysis tool specifically designed to analyze bacterial genomes. Its main goal is to create accurate pangenomes by identifying and grouping genes that are shared or unique across multiple genomes within a species. Panaroo is built to overcome some of the challenges in pangenome analysis, especially issues with paralogs (genes that arise by duplication within the same genome) and annotation inconsistencies between different genome assemblies.

    ]]></help>
    <citations>
        <citation type="doi">10.1186/s13059-020-02090-4</citation>
    </citations>
</tool>